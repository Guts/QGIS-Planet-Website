---
source: "blog"
title: "Rendering Points as a Heatmap in GeoServer"
date: "2025-01-17T00:00:00"
link: "https://kartoza.com/blog/geoserver/rendering-points-as-a-heatmap-in-geoserver"
draft: "false"
showcase: "planet"
subscribers: ["kartoza"]
author: "Kartoza"
tags: ["geoserver"]
languages: ["en_gb"]
available_languages: ["en_gb"]
---

<div class="ql-editor read-mode"><h1>Rendering Points as a Heatmap in GeoServer</h1><p><br /></p><p>I was assigned the task of rendering a points layer as a heatmap on GeoServer. The client provided a QGIS style that they wanted replicated using an SLD (Styled Layer Descriptor). Initially, they attempted to export the QGIS style directly as an SLD and upload it to GeoServer. However, this approach failed because QGIS generated the heatmap SLD as:</p><p><br /></p><pre class="ql-code-block-container"><div class="ql-code-block">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="ql-code-block">&lt;StyledLayerDescriptor xmlns="http://www.opengis.net/sld" xsi:schemaLocation="http://www.opengis.net/sld http://schemas.opengis.net/sld/1.1.0/StyledLayerDescriptor.xsd" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1.1.0" xmlns:ogc="http://www.opengis.net/ogc" xmlns:se="http://www.opengis.net/se"&gt;</div><div class="ql-code-block"> &nbsp;&lt;NamedLayer&gt;</div><div class="ql-code-block"> &nbsp; &nbsp;&lt;se:Name&gt;Current_Layer&lt;/se:Name&gt;</div><div class="ql-code-block"> &nbsp; &nbsp;&lt;UserStyle&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp;&lt;se:Name&gt;Current_style&lt;/se:Name&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp;&lt;se:FeatureTypeStyle&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;!--FeatureRenderer heatmapRenderer not implemented yet--&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp;&lt;/se:FeatureTypeStyle&gt;</div><div class="ql-code-block"> &nbsp; &nbsp;&lt;/UserStyle&gt;</div><div class="ql-code-block"> &nbsp;&lt;/NamedLayer&gt;</div><div class="ql-code-block">&lt;/StyledLayerDescriptor&gt;</div></pre><p><br /></p><p>The main issue was the line:</p><pre class="ql-code-block-container"><div class="ql-code-block">&lt;!--FeatureRenderer heatmapRenderer not implemented yet--&gt;</div></pre><p>, indicating that the style was essentially saved as blank or non-renderable. This was simply how the style was exported from QGIS.</p><p><br /></p><p>The first step in addressing the request was to visit the <a href="https://docs.geoserver.org/latest/en/user/styling/index.html#styling" rel="noopener noreferrer">GeoServer Styling Manual</a> and see if there was any example documentation that could help. There was an explanation of how to generate a heatmap style in the Rendering Transformations' <a href="https://docs.geoserver.org/latest/en/user/styling/sld/extensions/rendering-transform.html#heatmap-generation" rel="noopener noreferrer">Heatmap Generation</a> documentation as well as an example of a heatmap SLD.</p><p><br /></p><p>Using the example from the documentation as a basis, I made a few adjustments to ensure the style met the clientâ€™s requirements. Here is what the initial heatmap style looked like:</p><p><br /></p><pre class="ql-code-block-container"><div class="ql-code-block">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</div><div class="ql-code-block">&lt;StyledLayerDescriptor version="1.0.0"</div><div class="ql-code-block"> &nbsp; &nbsp;xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"</div><div class="ql-code-block"> &nbsp; &nbsp;xmlns="http://www.opengis.net/sld"</div><div class="ql-code-block"> &nbsp; &nbsp;xmlns:ogc="http://www.opengis.net/ogc"</div><div class="ql-code-block"> &nbsp; &nbsp;xmlns:xlink="http://www.w3.org/1999/xlink"</div><div class="ql-code-block"> &nbsp; &nbsp;xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;</div><div class="ql-code-block"> &nbsp;&lt;NamedLayer&gt;</div><div class="ql-code-block"> &nbsp; &nbsp;&lt;Name&gt;Heatmap Style&lt;/Name&gt;</div><div class="ql-code-block"> &nbsp; &nbsp;&lt;UserStyle&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp;&lt;Title&gt;Heatmap Style&lt;/Title&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp;&lt;Abstract&gt;&lt;/Abstract&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp;&lt;FeatureTypeStyle&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;Transformation&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="vec:Heatmap"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;data&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;weightAttr&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;geometry&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;radiusPixels&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;75&lt;/ogc:Literal&gt; &lt;!-- Spread of heatmap around points, set a number below 100 to reduce spread of heatmap --&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;pixelsPerCell&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;5&lt;/ogc:Literal&gt; &lt;!-- Set a small number here to generate a higher resolution heatmap --&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;outputBBOX&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="env"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;wms_bbox&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;outputWidth&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="env"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;wms_width&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;outputHeight&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="env"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;wms_height&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/Transformation&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;Rule&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;RasterSymbolizer&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Geometry&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:PropertyName&gt;geometry&lt;/ogc:PropertyName&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/Geometry&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Opacity&gt;0.5&lt;/Opacity&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ColorMap type="ramp"&gt; &lt;!-- The quantity specifies the percentage of the data range on which to change the colour --&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ColorMapEntry color="#FFFFFF" quantity="0" label="" opacity="0"/&gt; &lt;!-- This is needed to have empty areas around the heatmap 'islands' --&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ColorMapEntry color="#4444FF" quantity=".1" label=""/&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ColorMapEntry color="#00FFAE" quantity=".3" label=""/&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ColorMapEntry color="#FF0000" quantity=".5" label="" /&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ColorMapEntry color="#FFAE00" quantity=".75" label=""/&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ColorMapEntry color="#FFFF00" quantity="1.0" label="" /&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ColorMap&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/RasterSymbolizer&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/Rule&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp;&lt;/FeatureTypeStyle&gt;</div><div class="ql-code-block"> &nbsp; &nbsp;&lt;/UserStyle&gt;</div><div class="ql-code-block"> &nbsp;&lt;/NamedLayer&gt;</div><div class="ql-code-block">&lt;/StyledLayerDescriptor&gt;</div></pre><p><br /></p><p>Inline comments were added to the SLD to help the client understand which lines they could modify if needed.</p><p><br /></p><p>The primary adjustments made to the example style are as follows:</p><p><br /></p><p>- Setting the `weightAttr` as `geometry` so that specified input attribute is the geometry of the various points.</p><p>- Adjusting the `radiusPixels` and the `pixelsPerCell` values.</p><p>- Adding additional stops in the colour ramp.</p><p>- Changing the hexcodes of the colours in the colour ramp to be the same as the example heatmap.</p><p><br /></p><p>While generating the heatmap style, an issue frequently occurred with GeoServerâ€™s built-in style previewer, which did not display the style accurately. As a result, I had to check the results on the front-end map after every change. This limitation is evident in the screenshot below, where the GeoServer preview lacks a proper front-end to display the styled dummy data, making it appear different from how it would look on an actual map.</p><p><br /></p><p><img src="https://kartoza.com/files/geoserver_1.png" /></p><p><br /></p><p>The generated heatmap looked like this when rendered correctly (this is dummy data and not the actual data):</p><p><br /></p><p><img src="https://kartoza.com/files/heatmap_1.png" /></p><p><br /></p><p>The client was pleased with the heatmap but later requested additional functionality: displaying the relative counts of the various heatmap surfaces. This prompted me to research whether anyone had implemented something similar that I could use as a reference. After an extensive search yielded no results, I decided to experiment and create a custom SLD to meet the clientâ€™s requirements.</p><p><br /></p><p>I had previously been shown and used the <a href="https://docs.geoserver.org/latest/en/user/styling/ysld/reference/transforms.html#point-stacker" rel="noopener noreferrer">Point Stacker</a> logic in GeoServer to do clustered symbol displays so I used this as my base logic. The whole logic behind the clustered labelling display didn't need to be complex. All the labels would be the same size, and font, and they just needed to display a relative count.</p><p><br /></p><p>Given these criteria, I modified my existing Point Stacker logic to be simplified and it looked like this:</p><p><br /></p><pre class="ql-code-block-container"><div class="ql-code-block"> &nbsp; &nbsp;&lt;FeatureTypeStyle&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp;&lt;Transformation&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="gs:PointStacker"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;data&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;cellSize&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;20&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;outputBBOX&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="env"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;ogc:Literal&gt;wms_bbox&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;outputWidth&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="env"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;ogc:Literal&gt;wms_width&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;outputHeight&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="env"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;wms_height&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp;&lt;/Transformation&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &lt;Rule&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;Name&gt;Clusters&lt;/Name&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;Title&gt;Clusters&lt;/Title&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Filter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:PropertyIsGreaterThanOrEqualTo&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:PropertyName&gt;count&lt;/ogc:PropertyName&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;5&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:PropertyIsGreaterThanOrEqualTo&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Filter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;TextSymbolizer&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Label&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:PropertyName&gt;count&lt;/ogc:PropertyName&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/Label&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Font&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;CssParameter name="font-family"&gt;Arial&lt;/CssParameter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;CssParameter name="font-size"&gt;10&lt;/CssParameter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;CssParameter name="font-weight"&gt;bold&lt;/CssParameter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/Font&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;LabelPlacement&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;PointPlacement&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;AnchorPoint&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;AnchorPointX&gt;0&lt;/AnchorPointX&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;AnchorPointY&gt;0&lt;/AnchorPointY&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/AnchorPoint&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/PointPlacement&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/LabelPlacement&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Halo&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Radius&gt;0.4&lt;/Radius&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Fill&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;CssParameter name="fill"&gt;#000000&lt;/CssParameter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;CssParameter name="fill-opacity"&gt;1&lt;/CssParameter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/Fill&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/Halo&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Fill&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;CssParameter name="fill"&gt;#FFFFFF&lt;/CssParameter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;CssParameter name="fill-opacity"&gt;1.0&lt;/CssParameter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/Fill&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/TextSymbolizer&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp;&lt;/Rule&gt;</div><div class="ql-code-block"> &nbsp; &nbsp;&lt;/FeatureTypeStyle&gt;</div></pre><p><br /></p><p>There is only one clustering rule as having different sized circles symbolizing different sized clusters was not needed. The `cellSize` was set to 20 map units so that all points within a grid cell of 20x20 map units get clustered together. The `count` property was set to be greater than or equal to 5, as during the creation of the style, it became apparent that labelling all of the clusters with fewer than 5 points overcrowded the map visually and did not add any more information.</p><p><br /></p><p>The next step was combining the logic for the heatmap and the labelled clusters. After multiple failed attempts, I found that I couldn't combine the two logics into one `FeatureTypeStyle` and needed two separate `FeatureTypeStyle` groups. From there I then played around with the ordering of the `FeatureTypeStyle` logic and learnt that the heatmap style needed to come first in the SLD.</p><p><br /></p><p>All the attempts led to this style:</p><p><br /></p><pre class="ql-code-block-container"><div class="ql-code-block">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</div><div class="ql-code-block"> &lt;StyledLayerDescriptor version="1.0.0"</div><div class="ql-code-block"> &nbsp;xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"</div><div class="ql-code-block"> &nbsp;xmlns="http://www.opengis.net/sld"</div><div class="ql-code-block"> &nbsp;xmlns:ogc="http://www.opengis.net/ogc"</div><div class="ql-code-block"> &nbsp;xmlns:xlink="http://www.w3.org/1999/xlink"</div><div class="ql-code-block"> &nbsp;xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</div><div class="ql-code-block"> &nbsp;xmlns:se="http://www.opengis.net/se"&gt;</div><div class="ql-code-block"> &nbsp;&lt;NamedLayer&gt;</div><div class="ql-code-block"> &nbsp; &lt;Name&gt;Cluster points&lt;/Name&gt;</div><div class="ql-code-block"> &nbsp; &lt;UserStyle&gt;</div><div class="ql-code-block"> &nbsp; &lt;!-- Styles can have names, titles and abstracts --&gt;</div><div class="ql-code-block"> &nbsp; &nbsp;&lt;Title&gt;Clustered points&lt;/Title&gt;</div><div class="ql-code-block"> &nbsp; &nbsp;&lt;Abstract&gt;Styling using cluster points server side&lt;/Abstract&gt;</div><div class="ql-code-block"> &nbsp; &nbsp;&lt;FeatureTypeStyle&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;Transformation&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="vec:Heatmap"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;data&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;weightAttr&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;geometry&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- Set a very small radius or remove this parameter --&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;radiusPixels&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;75&lt;/ogc:Literal&gt; &lt;!-- Reduced radius --&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;pixelsPerCell&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;5&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;outputBBOX&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="env"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;wms_bbox&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;outputWidth&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="env"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;wms_width&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;outputHeight&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="env"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;wms_height&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/Transformation&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;Rule&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;RasterSymbolizer&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Geometry&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:PropertyName&gt;geometry&lt;/ogc:PropertyName&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/Geometry&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Opacity&gt;0.5&lt;/Opacity&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ColorMap type="ramp"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ColorMapEntry color="#FFFFFF" quantity="0" label="" opacity="0"/&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ColorMapEntry color="#4444FF" quantity=".1" label=""/&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ColorMapEntry color="#00FFAE" quantity=".3" label=""/&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ColorMapEntry color="#FF0000" quantity=".5" label="" /&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ColorMapEntry color="#FFAE00" quantity=".75" label=""/&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ColorMapEntry color="#FFFF00" quantity="1.0" label="" /&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ColorMap&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/RasterSymbolizer&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/Rule&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp;&lt;/FeatureTypeStyle&gt;</div><div class="ql-code-block"> &nbsp; &nbsp;&lt;!-- Clustering and labelling logic --&gt;</div><div class="ql-code-block"> &nbsp; &nbsp;&lt;FeatureTypeStyle&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp;&lt;Transformation&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="gs:PointStacker"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;data&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;cellSize&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;20&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;outputBBOX&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="env"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;ogc:Literal&gt;wms_bbox&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;outputWidth&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="env"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;ogc:Literal&gt;wms_width&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="parameter"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;outputHeight&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Function name="env"&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;wms_height&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Function&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp;&lt;/Transformation&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &lt;Rule&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;Name&gt;Clusters&lt;/Name&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;Title&gt;Clusters&lt;/Title&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Filter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:PropertyIsGreaterThanOrEqualTo&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:PropertyName&gt;count&lt;/ogc:PropertyName&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:Literal&gt;5&lt;/ogc:Literal&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:PropertyIsGreaterThanOrEqualTo&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ogc:Filter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;TextSymbolizer&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Label&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ogc:PropertyName&gt;count&lt;/ogc:PropertyName&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/Label&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Font&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;CssParameter name="font-family"&gt;Arial&lt;/CssParameter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;CssParameter name="font-size"&gt;10&lt;/CssParameter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;CssParameter name="font-weight"&gt;bold&lt;/CssParameter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/Font&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;LabelPlacement&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;PointPlacement&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;AnchorPoint&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;AnchorPointX&gt;0&lt;/AnchorPointX&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;AnchorPointY&gt;0&lt;/AnchorPointY&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/AnchorPoint&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/PointPlacement&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/LabelPlacement&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Halo&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Radius&gt;0.4&lt;/Radius&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Fill&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;CssParameter name="fill"&gt;#000000&lt;/CssParameter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;CssParameter name="fill-opacity"&gt;1&lt;/CssParameter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/Fill&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/Halo&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Fill&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;CssParameter name="fill"&gt;#FFFFFF&lt;/CssParameter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;CssParameter name="fill-opacity"&gt;1.0&lt;/CssParameter&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/Fill&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/TextSymbolizer&gt;</div><div class="ql-code-block"> &nbsp; &nbsp; &nbsp;&lt;/Rule&gt;</div><div class="ql-code-block"> &nbsp; &nbsp;&lt;/FeatureTypeStyle&gt;</div><div class="ql-code-block"> &nbsp;&lt;/UserStyle&gt;</div><div class="ql-code-block"> &lt;/NamedLayer&gt;</div><div class="ql-code-block">&lt;/StyledLayerDescriptor&gt;</div></pre><p><br /></p><p>This style renders the points as a heatmap using the `geometry` attribute for weighting and then displays labels for clusters of points that are larger than 5. It looks like this (Again, this is dummy data and not the actual data):</p><p><br /></p><p><img src="https://kartoza.com/files/heatmap_2.png" /></p><p><br /></p><p>The style is functional and has been approved by the client. However, I would like to revisit the labelling logic to better align it with the heatmap styling. Specifically, I aim to have the labels correspond to the colour breaks in the heatmap rather than relying on a separate clustering logic.</p></div>
